var veen={indexedDB:{}};!function(){function e(e){return e}var n={NEXT:"next",NEXT_UNIQUE:"nextunique",PREV:"prev",PREV_UNIQUE:"prevunique"},o={READONLY:"readonly",READWRITE:"readwrite"},t={exposed:["clearTable","deleteDb","insertDoc","insertDocs","getById","getAllDocs","getDocsEquals","getDocsLessThan","getDocsGreaterThan","getDocsRange","updateAllDocs","updateDocsEquals","updateDocsLessThan","updateDocsGreaterThan","updateDocsRange","deleteDoc","deleteDocs","deleteAllDocs","deleteDocsEquals","deleteDocsLessThan","deleteDocsGreaterThan","deleteDocsRange"],addCommonMethods:function(e,n){e.onerror=function(e){n(e,!0)},e.oncomplete=function(e){n(e)},e.onsuccess=function(e){n(e)},e.onabort=function(e){n(e,!0)}},query:function(a,s,r,c,u,i,d,l,D){var v=a.transaction(r,c||o.READONLY),f=v.objectStore(r);d=void 0===d?null:d,u=u||n.NEXT,D=D||e,l=l||e,t.addCommonMethods(v,s),v.oncomplete=function(e){s(D(e))},i&&(f=f.index(i)),f=f.openCursor(d,u),f.onsuccess=function(e){var n=e.target.result;n&&(l(n),n["continue"]())}},queryWithClause:function(e,n,o,s,r,c,u,i,d){var l,D=a.window.IDBKeyRange,v={"<":"upperBound",">":"lowerBound","=":"only","<>":"bound"};if(u){var f=u.values,p=u.inclusive||[!0,!0],g=v[u.operator];l="<>"==u.operator?D[g](f[0],f[1],!p[0],!p[1]):D[g](f[0],!p[0])}t.query(e,n,o,s,r,c,l,i,d)},getDocsBase:function(a,s,r,c,u){function i(n){var o=e(n.value);o&&v.push(n.value)}function d(e){return v}var l=o.READONLY,D=n.NEXT,v=[];t.queryWithClause(a,s,r,l,D,c,u,i,d)},getAllDocs:function(e,n,o){t.getDocsBase(e,n,o)},getDocsEquals:function(e,n,o,a,s){t.getDocsBase(e,n,o,a,{operator:"=",values:[s]})},getDocsLessThan:function(e,n,o,a,s,r){t.getDocsBase(e,n,o,a,{operator:"<",values:[s],inclusive:[r]})},getDocsGreaterThan:function(e,n,o,a,s,r){t.getDocsBase(e,n,o,a,{operator:">",values:[s],inclusive:[r]})},getDocsRange:function(e,n,o,a,s,r,c,u){t.getDocsBase(e,n,o,a,{operator:"<>",values:[s,r],inclusive:[c,u]})},getById:function(e,n,a,s){var r=e.transaction(a,o.READWRITE),c=r.objectStore(a),u=c.get(s);t.addCommonMethods(r,n),r.oncomplete=function(e){n(u.result)}},updateDocsBase:function(e,a,s,r,c,u){function i(e){r(e.value),e.update(e.value),v.push(e.value)}function d(e){return v}var l=o.READWRITE,D=n.NEXT,v=[];t.queryWithClause(e,a,s,l,D,c,u,i,d)},updateAllDocs:function(e,n,o,a){t.updateDocsBase(e,n,o,a)},updateDocsEquals:function(e,n,o,a,s,r){t.updateDocsBase(e,n,o,r,a,{operator:"=",values:[s]})},updateDocsLessThan:function(e,n,o,a,s,r,c){t.updateDocsBase(e,n,o,r,a,{operator:"<",values:[s],inclusive:[c]})},updateDocsGreaterThan:function(e,n,o,a,s,r,c){t.updateDocsBase(e,n,o,r,a,{operator:">",values:[s],inclusive:[c]})},updateDocsRange:function(e,n,o,a,s,r,c,u,i){t.updateDocsBase(e,n,o,c,a,{operator:"<>",values:[s,r],inclusive:[u,i]})},insertDoc:function(e,n,a,s){var r=e.transaction(a,o.READWRITE),c=r.objectStore(a);t.addCommonMethods(r,n),c.put(s)},insertDocs:function(e,n,a,s){var r=e.transaction(a,o.READWRITE),c=r.objectStore(a);t.addCommonMethods(r,n);for(var u=0;u<s.length;u++){var i=s[u];c.put(i)}},deleteDocs:function(e,n,a,s,r){function c(e){var n="object"==typeof e;if(n){var o=r||"id";return e[o]}return e}var u=e.transaction(a,o.READWRITE),i=u.objectStore(a);t.addCommonMethods(u,n);for(var d=0;d<s.length;d++){var l=c(s[d]);i["delete"](l)}},deleteDoc:function(e,n,o,a,s){t.deleteDocs(e,n,o,[a],s)},deleteDocsBase:function(e,a,s,r,c){function u(e){D.push(e.value),e["delete"]()}function i(e){return D}var d=o.READWRITE,l=n.NEXT,D=[];t.queryWithClause(e,a,s,d,l,r,c,u,i)},deleteAllDocs:function(e,n,o,a){t.deleteDocsBase(e,n,o,a)},deleteDocsEquals:function(e,n,o,a,s){t.deleteDocsBase(e,n,o,a,{operator:"=",values:[s]})},deleteDocsLessThan:function(e,n,o,a,s,r){t.deleteDocsBase(e,n,o,a,{operator:"<",values:[s],inclusive:[r]})},deleteDocsGreaterThan:function(e,n,o,a,s,r){t.deleteDocsBase(e,n,o,a,{operator:">",values:[s],inclusive:[r]})},deleteDocsRange:function(e,n,o,a,s,r,c,u){t.deleteDocsBase(e,n,o,a,{operator:"<>",values:[s,r],inclusive:[c,u]})},deleteDb:function(e,n){e.close();var o=a.window.indexedDB.deleteDatabase(e.name);o.onerror=function(e){a.reset(),n(!1,!0)},o.onsuccess=function(e){n(!0)}},clearTable:function(e,n,a){var s=e.transaction(a,o.READWRITE),r=s.objectStore(a);t.addCommonMethods(s,n),r.clear()}},a={window:void 0,reset:function(){a.promise=void 0,a.window=void 0,a.db=void 0},promise:void 0,db:void 0,promiseWrapper:function(e){var n=new Promise(function(n,o){a.promise.then(function(t){e(t||a.db,function(e,t){var a=t?o:n;a(e)})})});return n},createDatabase:function(e,n,o,t){var s=new Promise(function(s,r){a.window=e,"indexedDB"in e||(e.indexedDB=e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB),"IDBTransaction"in e||(e.IDBTransaction=e.IDBTransaction||e.webkitIDBTransaction||e.msIDBTransaction),"IDBKeyRange"in e||(e.IDBKeyRange=e.IDBKeyRange||e.webkitIDBKeyRange||e.msIDBKeyRange);var c=e.indexedDB.open(n,o);c.onsuccess=function(e){var n=e.target.result;a.db=n,s(n)},c.onblocked=function(){},c.onerror=function(){},c.onupgradeneeded=function(e){for(var n=e.target.result,o=0;o<t.length;o++){var a,s=t[o];a=n.objectStoreNames.contains(s.name)?e.currentTarget.transaction.objectStore(s.name):n.createObjectStore(s.name,{keyPath:s.keyPath,unique:!0});for(var r=0;r<a.indexNames.length;r++){var c=a.indexNames[r];s.indexes.indexOf(c)<0&&a.deleteIndex(c,c,{unique:!1})}for(var u=0;u<s.indexes.length;u++){var c=s.indexes[u];a.indexNames.contains(c)||a.createIndex(c,c,{unique:!1})}}}});a.promise=s},wrapDbMethods:function(){for(var e={},n=t.exposed,o=0;o<n.length;o++)!function(){var s=n[o];e[s]=function(e,n,o,r,c,u,i,d,l,D,v){return a.promiseWrapper(function(a,f){var p=t[s];p(a,f,e,n,o,r,c,u,i,d,l,D,v)})}}();return e},init:function(e,n,o,t){return a.createDatabase(e,n,o,t),a.wrapDbMethods()}};veen.indexedDB.init=function(e,n,o){return a.init(window,e,n,o)}}(),module&&module.exports&&(module.exports=veen);